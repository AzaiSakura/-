## DNS域名解析过程

#### DNS即使用TCP又使用UDP，在区域传输的时候使用的TCP协议，其他时候使用的UDP协议。

#### DNS在区域传输的时候使用TCP协议：

1、辅域名服务器会定时（一般3小时）向主域名服务器进行查询以便了解数据是否变动，如果变动，会执行一次区域传送，进行数据同步。区域传送使用TCP而不是UDP，因为数据同步传送的数据量比一个请求应答的数据要多得多。

2、TCP是一种可靠连接，保证了数据的准确性。

#### DNS在域名解析过程中使用UDP协议：

客户端向DNS服务器查询域名，一般返回内容不超过512字节，用UDP传输即可。不用经过三次握手，这样DNS服务器负载更低，反应更快。理论上说，客户端也可以指定向DNS服务器查询时用TCP，但事实上，很多DNS服务器进行配置的时候，仅支持UDP查询包。

#### DNS在进行区域传输的时候使用TCP协议，其它时候则使用UDP协议； 

​    DNS的规范规定了2种类型的DNS服务器，一个叫**主DNS服务器**，一个叫**辅助DNS服务器**。在一个区中主DNS服务器从自己本机的数据文件中读取该区的DNS数据信息，而辅助DNS服务器则从区的主DNS服务器中读取该区的DNS数据信息。当一个辅助DNS服务器启动时，它需要与主DNS服务器通信，并加载数据信息，这就叫做区传送（zone transfer）。 

DNS是基于UDP的，原因是UDP是面向无连接，不要求准确，但是速度快的，DNS解析是一种查询服务 查询要求的是速度并不是精准度所以使用UDP，如果使用TCP的话那么查询时间就会变得很久。

### 图书馆借书的流程就和DNS域名解析过程很相似

![image-20211106152145848](C:\Users\11791\AppData\Roaming\Typora\typora-user-images\image-20211106152145848.png)





![image-20211106152423567](C:\Users\11791\AppData\Roaming\Typora\typora-user-images\image-20211106152423567.png)



![image-20211106152622916](C:\Users\11791\AppData\Roaming\Typora\typora-user-images\image-20211106152622916.png)

### 域名解析过程：

![image-20211106153619609](C:\Users\11791\AppData\Roaming\Typora\typora-user-images\image-20211106153619609.png)

上面这个是没有缓存的情况

如果有缓存的话就不用这么多步骤（强缓存就可以直接在本地获取资源，协商缓存就要判定这个缓存是否过期）