## TCP/IP网络模型

对于同一台设备上的进程之间的通信方式有很多，比如**管道、消息队列、共享内存、信号等方式**，而对于不同设备上的进程间通信，就需要网络通信，而设备是多样性的，所以要兼容多种多样的设备，就协商出了网络协议。

TCP/IP的五层网络模型

<img src="C:\Users\11791\AppData\Roaming\Typora\typora-user-images\image-20211123114701235.png" alt="image-20211123114701235" style="zoom:50%;" />

## 五层各个的作用：

### 应用层：我们电脑和手机使用的应用软件都是在应用层实现的。那么当两个不同设备的应用需要同行的时候应用就会把应用数据传给下一层就是传输层。

应用层只需要专注于用户提供应用功能，不必关心数据是如何传输的，就类似于，我们寄快递的时候，只需要把包裹交给快递员，由他负责运输快递，我们不需要关心快递是如何运行的。

应用层协议：http  https



### 传输层：应用层的数据包会传递给传输层，传输层是为应用层提供网络支持的。 

传输层协议：TCP  UDP

TCP：传输层控制协议，大部分应用都使用的是TCP传输层协议，比如HTTP应用层协议。TCP相比于UDP多了很多特性，比如流量控制、超时重传、拥塞控制等，都是为了保证数据包能**可靠**地传输给对方。

UDP： UDP只负责发送数据包，不保证数据包是否能抵达对方，但他实时性相对更好，传输效率也更高。当然UDP也可以实现可靠传输，把TCP特性在应用层上实现就可以了，不过要实现一个商用可靠的UDP传输协议，也不是一件简单的事情。

应用需要传输的数据可能会非常的大，如果直接传输就不好控制，因此当传输层的数据包大小超过**MSS**（TCP最大报文长度），就要将数据包**分块**，这样即使途中有一**分块**丢失或者损坏，只需要重新传这个**分块**而不用重发整个数据包。在TCP协议中，我们把每个**分块**称为TCP段

<img src="C:\Users\11791\AppData\Roaming\Typora\typora-user-images\image-20211123120106566.png" alt="image-20211123120106566" style="zoom:50%;" />

当设备作为接收方时，传输层则需要负责把数据包传给应用，但是一个设备上可能会有很多应用在接受或者传输数据，因此需要一个编号来将应用区分开来，所以这个编号就是**端口**

一般来说，80端口通常是Web服务器用的，22端口是远程登录服务器用的。

### 传输层的协议报文中会携带端口号，因此接收方可以识别出该报文是发送给哪个应用的。



### 网络层：

传输层的设计初衷就是为了简单、高效、专注，让他只为应用层服务，帮助实现应用到应用的同行，而实际的传输功能给了下一层，网络层。

网络层协议：IP协议

IP协议将传输层的报文作为数据部分，在加上IP包头组装成IP报文，如果IP报文大小超过MTU（以太网中一般为1500字节）就会再次进行分片，在得到一个即将发送到网络的IP报文

![image-20211123121608107](C:\Users\11791\AppData\Roaming\Typora\typora-user-images\image-20211123121608107.png)

网络层负责将数据从一个设备传输到另外一个设备上，为了找到对应的设备，因此网络层需要有区分设备的编号。

我们一般用IP地址给设备进行编号，对于IPv4协议，IP地址共32位，分成了四段，每段有8位。只有一个单纯的IP地址虽然做到了区分设备，但是寻址起来就很麻烦。

因此IP地址分成两种意义：

一个是**网络号**， 负责标识该IP地址是属于哪个子网的

一个是**主机号**，负责标识同一子网下的不同主机；

IP 协议的寻址作⽤是告诉我们去往下⼀个⽬的地该朝哪个⽅向⾛，路由则是根据「下⼀个⽬的地」选择路径。寻址更像在导航，路由更像在操作⽅向盘



### 数据链路层：

一旦数据需要跨网络传输，就需要有一个设备同时在两个网络当中，这个设备一般是路由器，路由器可以通过路由表计算出下一个要去的IP地址。

为了有一个专门的层来表示网络中的设备，让数据在一个链路中传输，这就是数据链路层，他主要为网络层提供链路级别传输的服务。

每一台设备的网卡都会有一个MAC地址，他的作用就是用来唯一表示设备的。路由器计算出了下一个目的地IP地址，在通过ARP协议找到该目的地的MAC地址，这样就知道这个IP地址是哪个设备的了。

### 物理层：

当数据准备要从设备发送到网络时，需要把数据包转换成电信号，让其在物理介质中传输，这一层就是物理层



