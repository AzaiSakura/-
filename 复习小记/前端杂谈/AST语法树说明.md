## AST语法树说明

### 为什么ES6箭头函数直接返回一个对象的时候需要加扩号否则报错？

```js

let fn1 = ()=>{a:123,b:456}; //这样会报错
//但是
let fn1 =()=>({a:123,b:456});//这样就是合理的
let fn2 = ()=>{a:123};//不报错


/*ES6写法中：
let fn3 = ()=>{a:123};
转化为ES5：
	function fn4(){
		a:123;
	}
	对象的大括号，被解析成了函数的大括号
	从
*/
```

为什么一个不报错两个就报错呢，第一行代码和第三行。

从AST语法树的角度来看,

a：123能正常解析所以不会报错

在AST中{a:123}和a:123在AST中都是正确的

但是

```
a:123,b:456 和 {a:123,b:456}是不同的，且前者是错的所以报错
```

## AST（抽象语法树）

第一部分：AST的作用

首先来一个比较形象的，讲述了为什么需要讲源代码转化为AST，总结就是：AST不依赖具体的文法，不依赖于语言的细节，我们将源码转化为AST后，可以对AST做很多的操作。

原文为：

抽象语法树简介：

AST是源代码的抽象语法结构的树状结构，树上的每个结点都表示源代码中的一种结构，所以说是抽象的，是因为抽象语法树并不会表示出真实语法出现的每一个细节，比如说，嵌套括号是被隐含在树的结构中，并没有以节点的形式呈现。抽象语法树并不依赖于源语言的语法，也就是说语法分析阶段所采用的上下文无文文法，因为在写文法时，经常会对文法进行等价的转化（消除左递归，回溯，二义性等），这样会给文法分析引入一些多余的成分，对后续阶段造成不利影响，甚至会使各个阶段变得混乱。因些，很多编译器经常要独立地构造语法分析树，为前端、后端建立一个清晰的接口。

抽象语法树在很多领域有广泛的应用，比如浏览器、只能编译器，编译器。

## AST实例

1、四则运算表达式

表达式：1+3*(4-1)+2

<img src="C:\Users\11791\AppData\Roaming\Typora\typora-user-images\image-20220325152418140.png" alt="image-20220325152418140" style="zoom:80%;" />

2、代码

```js
while b != 0
{
    if a > b
        a = a-b
    else
        b = b-a
}
return a
 
```

<img src="C:\Users\11791\AppData\Roaming\Typora\typora-user-images\image-20220325152543629.png" alt="image-20220325152543629" style="zoom:80%;" />

## 为什么需要AST

在如今前端项目的任何开发依赖中，我们都可以看到他的增长量是多么的大。我们确实在其中获取到了一些非常好用的工具包括：javascript转译（balbel）、eslint、css预处理器、代码压缩、prettier等。这些是我们不交付生产的JS模块，但是他们确实在我们开发过程中发挥了相当强力的作用。所有这些工具，无论以何种方式，都建立在AST处理之上。

